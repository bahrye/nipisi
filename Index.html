<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;600;700&display=swap');
    body { font-family: 'Plus Jakarta Sans', sans-serif; background-color: #f8fafc; color: #1e293b; }
    .card-shadow { box-shadow: 0 4px 20px -2px rgba(0, 0, 0, 0.05); }
    .glass { background: rgba(255, 255, 255, 0.95); backdrop-filter: blur(10px); }
    .loader {
      border: 3px solid #f3f3f3; border-radius: 50%; border-top: 3px solid #3498db;
      width: 20px; height: 20px; animation: spin 1s linear infinite; display: inline-block;
    }
    @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
    
    /* Grid Menu Kustom */
    .menu-icon {
        width: 50px; height: 50px; border-radius: 18px; 
        display: flex; align-items: center; justify-content: center; 
        margin-bottom: 6px; box-shadow: 0 2px 10px rgba(0,0,0,0.03);
    }
  </style>
</head>
<body class="pb-28">

  <header class="bg-blue-600 text-white p-6 rounded-b-[40px] shadow-lg sticky top-0 z-50">
    <div class="flex justify-between items-center mb-4">
      <div>
        <h1 class="text-2xl font-bold tracking-tight">Nipisi Digital</h1>
        <p class="text-[10px] opacity-80 uppercase tracking-widest font-semibold">Kec. Herlang, Bulukumba</p>
      </div>
      <button onclick="showAdminLogin()" class="bg-white/20 p-2 rounded-full hover:bg-white/30 transition">
        <i class="fa fa-lock-open text-sm"></i>
      </button>
    </div>
    
    <div class="bg-black/10 p-2 rounded-2xl text-[11px] flex items-center">
      <span class="bg-yellow-400 text-blue-900 px-2 py-0.5 rounded-lg font-bold mr-2 uppercase">Info</span>
      <marquee id="marquee-text" class="font-medium text-white">Sinkronisasi data...</marquee>
    </div>
  </header>

  <main class="px-5 mt-6">
    
    <div class="grid grid-cols-4 gap-4 mb-8">
      <div onclick="showSurat()" class="flex flex-col items-center cursor-pointer active:scale-95 transition">
        <div class="menu-icon bg-blue-100 text-blue-600"><i class="fa fa-envelope text-xl"></i></div>
        <span class="text-[10px] font-bold opacity-70">SURAT</span>
      </div>
      <div onclick="showHarga()" class="flex flex-col items-center cursor-pointer active:scale-95 transition">
        <div class="menu-icon bg-green-100 text-green-600"><i class="fa fa-chart-line text-xl"></i></div>
        <span class="text-[10px] font-bold opacity-70">HARGA</span>
      </div>
      <div onclick="showAgenda()" class="flex flex-col items-center cursor-pointer active:scale-95 transition">
        <div class="menu-icon bg-purple-100 text-purple-600"><i class="fa fa-calendar-alt text-xl"></i></div>
        <span class="text-[10px] font-bold opacity-70">AGENDA</span>
      </div>
      <div onclick="showIuran()" class="flex flex-col items-center cursor-pointer active:scale-95 transition">
        <div class="menu-icon bg-indigo-100 text-indigo-600"><i class="fa fa-wallet text-xl"></i></div>
        <span class="text-[10px] font-bold opacity-70">IURAN</span>
      </div>

      <div onclick="showGaleri()" class="flex flex-col items-center cursor-pointer active:scale-95 transition">
        <div class="menu-icon bg-pink-100 text-pink-600"><i class="fa fa-images text-xl"></i></div>
        <span class="text-[10px] font-bold opacity-70">GALERI</span>
      </div>
      <div onclick="showLapor()" class="flex flex-col items-center cursor-pointer active:scale-95 transition">
        <div class="menu-icon bg-orange-100 text-orange-600"><i class="fa fa-bullhorn text-xl"></i></div>
        <span class="text-[10px] font-bold opacity-70">LAPOR</span>
      </div>
      <div onclick="showEmergency()" class="flex flex-col items-center cursor-pointer active:scale-95 transition">
        <div class="menu-icon bg-red-100 text-red-600"><i class="fa fa-phone-alt text-xl"></i></div>
        <span class="text-[10px] font-bold opacity-70">DARURAT</span>
      </div>
      <div onclick="loadSection('map')" class="flex flex-col items-center cursor-pointer active:scale-95 transition">
        <div class="menu-icon bg-teal-100 text-teal-600"><i class="fa fa-map-marked-alt text-xl"></i></div>
        <span class="text-[10px] font-bold opacity-70">PETA</span>
      </div>
    </div>

    <div id="dynamic-content" class="space-y-6 min-h-[300px]">
      <div class="py-20 text-center text-gray-400">
        <div class="loader mb-2"></div>
        <p class="text-sm">Memuat Data...</p>
      </div>
    </div>
  </main>

  <footer class="text-center py-6 text-[10px] text-gray-400">
    <p>&copy; <span id="currentYear"></span> Nipisi Digital - Herlang</p>
  </footer>

  <nav class="fixed bottom-0 w-full glass border-t border-gray-100 px-8 py-4 flex justify-between items-center z-50">
    <button id="nav-home" onclick="loadSection('home')" class="flex flex-col items-center gap-1 text-blue-600 transition">
      <i class="fa fa-home text-xl"></i><span class="text-[9px] font-bold uppercase">Beranda</span>
    </button>
    <button id="nav-market" onclick="loadSection('market')" class="flex flex-col items-center gap-1 text-gray-400 transition">
      <i class="fa fa-store text-xl"></i><span class="text-[9px] font-bold uppercase">Pasar</span>
    </button>
    <button id="nav-profile" onclick="loadSection('profile')" class="flex flex-col items-center gap-1 text-gray-400 transition">
      <i class="fa fa-user-circle text-xl"></i><span class="text-[9px] font-bold uppercase">Profil</span>
    </button>
  </nav>

  <script>
    var masterData = {};

    window.onload = function() {
      document.getElementById('currentYear').innerText = new Date().getFullYear();
      google.script.run.withSuccessHandler(function(data) {
        masterData = data;
        var info = "Selamat Datang di Nipisi Digital!";
        if(masterData.pengumuman && masterData.pengumuman.length > 0) info = masterData.pengumuman[0].Isi || info;
        document.getElementById('marquee-text').innerText = info;
        loadSection('home');
      }).getAppData();
    };

    function loadSection(section) {
      // Reset Nav
      ['nav-home', 'nav-market', 'nav-profile'].forEach(id => {
        var el = document.getElementById(id);
        if(el) { el.classList.remove('text-blue-600'); el.classList.add('text-gray-400'); }
      });
      var active = document.getElementById('nav-'+section);
      if(active) { active.classList.remove('text-gray-400'); active.classList.add('text-blue-600'); }

      var container = document.getElementById('dynamic-content');
      var html = "";

      // === HOME ===
      if(section === 'home') {
        html += '<div class="relative mb-6">';
        html += '<input type="text" onkeyup="searchProduct(this.value)" placeholder="Cari kebutuhan..." class="w-full p-4 pl-12 rounded-2xl border-none shadow-sm text-sm focus:ring-2 focus:ring-blue-400 bg-white">';
        html += '<i class="fa fa-search absolute left-4 top-4.5 text-gray-300"></i></div>';
        html += '<h3 class="font-bold text-gray-800 text-lg flex items-center gap-2 mb-4"><i class="fa fa-shopping-bag text-blue-500"></i> Produk Warga</h3>';
        html += '<div id="product-list" class="grid grid-cols-2 gap-4">';
        
        if (masterData.produk && masterData.produk.length > 0) {
            masterData.produk.forEach(p => {
                html += `<div class="bg-white rounded-[24px] overflow-hidden card-shadow border border-white flex flex-col">
                  <div class="h-32 bg-gray-100 w-full overflow-hidden">
                     <img src="${p.GambarURL || 'https://via.placeholder.com/300'}" class="w-full h-full object-cover">
                  </div>
                  <div class="p-3 flex flex-col flex-grow">
                      <p class="text-[8px] font-bold text-blue-500 uppercase">${p.Kategori}</p>
                      <h4 class="text-sm font-bold text-gray-800 truncate mb-1">${p['Nama Barang']}</h4>
                      <div class="flex justify-between items-center mt-auto">
                        <span class="text-blue-600 font-extrabold text-sm">Rp${Number(p.Harga).toLocaleString()}</span>
                        <button onclick="orderWA('${p.WhatsApp}', '${p['Nama Barang']}')" class="bg-blue-600 text-white w-8 h-8 rounded-full flex items-center justify-center shadow-md"><i class="fa fa-plus text-xs"></i></button>
                      </div>
                  </div>
                </div>`;
            });
        } else { html += '<p class="col-span-2 text-center text-xs text-gray-400 py-10">Belum ada produk.</p>'; }
        html += '</div>';
        container.innerHTML = html;
      }

      // === MARKET (TOKO) ===
      else if(section === 'market') {
        html += '<h3 class="font-bold text-gray-800 text-lg mb-4"><i class="fa fa-store text-blue-500 mr-2"></i>UMKM Nipisi</h3>';
        html += '<div class="space-y-4">';
        if (masterData.toko && masterData.toko.length > 0) {
           masterData.toko.forEach(t => {
             html += `<div class="bg-white p-4 rounded-[24px] card-shadow flex gap-4 items-center">
                <div class="w-16 h-16 rounded-2xl bg-blue-50 overflow-hidden shrink-0"><img src="${t.GambarURL || 'https://via.placeholder.com/100'}" class="w-full h-full object-cover"></div>
                <div class="flex-grow">
                  <h4 class="font-bold text-gray-800 text-sm">${t['Nama Toko']}</h4>
                  <p class="text-[10px] text-gray-500 font-bold uppercase">${t['Pemilik']}</p>
                  <p class="text-[10px] text-gray-400 italic truncate w-40">${t['Deskripsi'] || 'Usaha warga'}</p>
                </div>
                ${t['WhatsApp'] ? `<button onclick="window.open('https://wa.me/${t['WhatsApp']}', '_blank')" class="w-10 h-10 rounded-full bg-green-100 text-green-600 flex items-center justify-center"><i class="fab fa-whatsapp"></i></button>` : ''}
             </div>`;
           });
        } else { html += '<p class="text-center text-xs text-gray-400 py-10">Data toko kosong.</p>'; }
        html += '</div>';
        container.innerHTML = html;
      }

      // === PROFILE ===
      else if(section === 'profile') {
        container.innerHTML = `<div class="bg-white p-8 rounded-[32px] text-center card-shadow">
            <div class="w-24 h-24 mx-auto mb-4 bg-blue-100 rounded-full overflow-hidden p-1"><img src="https://cdn-icons-png.flaticon.com/512/3135/3135715.png" class="w-full h-full rounded-full bg-white"></div>
            <h2 class="text-xl font-bold">Admin Lingkungan</h2>
            <p class="text-blue-600 text-sm font-medium mb-6">Nipisi, Herlang</p>
            <div class="bg-slate-50 p-4 rounded-2xl"><p class="text-[10px] text-gray-400 uppercase font-bold">Produk Terdaftar</p><p class="text-lg font-bold text-slate-800">${masterData.produk ? masterData.produk.length : 0}</p></div>
          </div>`;
      }
      
      // === PETA ===
      else if(section === 'map') {
        container.innerHTML = `<div class="bg-white p-4 rounded-[32px] card-shadow h-[400px] flex flex-col">
            <h3 class="font-bold mb-4 px-2">Peta Nipisi - Herlang</h3>
            <div class="flex-grow bg-slate-100 rounded-2xl overflow-hidden relative">
               <iframe src="https://maps.google.com/maps?q=-5.420849968138382,120.4094769294055&hl=id&z=16&output=embed" width="100%" height="100%" style="border:0;" allowfullscreen="" loading="lazy"></iframe>
            </div>
            <p class="text-center text-[10px] text-gray-400 mt-2">Titik Koordinat: -5.4208, 120.409</p>
          </div>`;
      }
    }

    // --- FITUR BARU 1: SURAT PENGANTAR ---
    function showSurat() {
      document.getElementById('dynamic-content').innerHTML = `
        <div class="bg-white p-6 rounded-[32px] card-shadow border border-blue-50">
          <h3 class="font-bold text-lg mb-4 text-blue-600"><i class="fa fa-envelope mr-2"></i>Request Surat</h3>
          <p class="text-xs text-gray-400 mb-4">Ajukan surat pengantar RT/Lingkungan secara online.</p>
          <input id="s-nama" placeholder="Nama Lengkap" class="w-full p-4 mb-3 rounded-2xl bg-slate-50 border-none text-sm">
          <input id="s-nik" placeholder="NIK (16 Digit)" type="number" class="w-full p-4 mb-3 rounded-2xl bg-slate-50 border-none text-sm">
          <select id="s-jenis" class="w-full p-4 mb-3 rounded-2xl bg-slate-50 border-none text-sm text-gray-600">
            <option value="">Pilih Jenis Surat</option>
            <option>Surat Pengantar KTP</option>
            <option>Surat Pengantar KK</option>
            <option>Surat Keterangan Usaha</option>
            <option>Surat Keterangan Domisili</option>
            <option>Surat Keterangan Tidak Mampu</option>
            <option>Lainnya</option>
          </select>
          <textarea id="s-perlu" placeholder="Keperluan Spesifik..." class="w-full p-4 mb-4 rounded-2xl bg-slate-50 border-none text-sm" rows="3"></textarea>
          <button onclick="kirimSurat()" class="w-full bg-blue-600 text-white py-4 rounded-2xl font-bold text-sm shadow-lg shadow-blue-200">Kirim Permohonan</button>
        </div>`;
    }

    function kirimSurat() {
      const obj = {
        nama: document.getElementById('s-nama').value,
        nik: document.getElementById('s-nik').value,
        jenis: document.getElementById('s-jenis').value,
        perlu: document.getElementById('s-perlu').value
      };
      if(!obj.nama || !obj.nik || !obj.jenis) return alert("Mohon lengkapi data!");
      
      const btn = event.target; btn.innerText = "Mengirim..."; btn.disabled = true;
      google.script.run.withSuccessHandler(res => { alert(res); loadSection('home'); }).submitSurat(obj);
    }

    // --- FITUR BARU 2: INFO HARGA ---
    function showHarga() {
      let html = `<div class="bg-white p-6 rounded-[32px] card-shadow border border-green-50">
        <h3 class="font-bold text-lg mb-4 text-green-600"><i class="fa fa-chart-line mr-2"></i>Harga Komoditas</h3>
        <p class="text-xs text-gray-400 mb-4">Info harga pasar area Herlang & Sekitarnya.</p>
        <div class="space-y-3">`;
      
      if(masterData.harga && masterData.harga.length > 0) {
        masterData.harga.forEach(h => {
          let icon = h.Tren === 'Naik' ? '<i class="fa fa-arrow-up text-green-500"></i>' : (h.Tren === 'Turun' ? '<i class="fa fa-arrow-down text-red-500"></i>' : '<i class="fa fa-minus text-gray-400"></i>');
          html += `<div class="flex justify-between items-center p-3 bg-slate-50 rounded-2xl">
            <div><p class="font-bold text-gray-700 text-sm">${h.Komoditas}</p><p class="text-[10px] text-gray-400">${h.Satuan || '/kg'}</p></div>
            <div class="text-right"><p class="font-bold text-green-600">Rp${Number(h.Harga).toLocaleString()}</p><p class="text-[10px]">${icon} ${h.Tren || 'Stabil'}</p></div>
          </div>`;
        });
      } else { html += `<p class="text-center text-xs text-gray-400">Belum ada data harga.</p>`; }
      html += `</div></div>`;
      document.getElementById('dynamic-content').innerHTML = html;
    }

    // --- FITUR BARU 3: AGENDA ---
    function showAgenda() {
      let html = `<div class="bg-white p-6 rounded-[32px] card-shadow border border-purple-50">
        <h3 class="font-bold text-lg mb-4 text-purple-600"><i class="fa fa-calendar-alt mr-2"></i>Agenda Lingkungan</h3>
        <div class="space-y-4">`;
      
      if(masterData.agenda && masterData.agenda.length > 0) {
        masterData.agenda.forEach(a => {
           // Format Tanggal
           let date = new Date(a.Tanggal);
           let day = date.getDate();
           let month = date.toLocaleString('id-ID', { month: 'short' });

           html += `<div class="flex gap-4 items-start">
             <div class="bg-purple-100 text-purple-600 rounded-2xl w-14 h-14 flex flex-col items-center justify-center shrink-0">
               <span class="text-lg font-bold leading-none">${day}</span><span class="text-[9px] uppercase font-bold">${month}</span>
             </div>
             <div>
               <h4 class="font-bold text-gray-800 text-sm">${a.Kegiatan}</h4>
               <p class="text-xs text-gray-500 mt-1"><i class="fa fa-clock mr-1 text-purple-400"></i>${a.Waktu ? new Date(a.Waktu).toLocaleTimeString('id-ID', {hour:'2-digit', minute:'2-digit'}) : 'Tentative'} WITA</p>
               <p class="text-xs text-gray-500"><i class="fa fa-map-marker-alt mr-1 text-purple-400"></i>${a.Lokasi}</p>
             </div>
           </div>`;
        });
      } else { html += `<p class="text-center text-xs text-gray-400">Tidak ada agenda dalam waktu dekat.</p>`; }
      html += `</div></div>`;
      document.getElementById('dynamic-content').innerHTML = html;
    }

    // --- FITUR BARU 4: GALERI ---
    function showGaleri() {
      let html = `<div class="bg-white p-4 rounded-[32px] card-shadow">
        <h3 class="font-bold text-lg mb-4 text-pink-600 px-2"><i class="fa fa-images mr-2"></i>Galeri Kegiatan</h3>
        <div class="grid grid-cols-2 gap-3">`;
      
      if(masterData.galeri && masterData.galeri.length > 0) {
        masterData.galeri.forEach(g => {
          html += `<div class="relative rounded-2xl overflow-hidden h-32 bg-gray-100 group">
            <img src="${g.FotoURL}" class="w-full h-full object-cover">
            <div class="absolute bottom-0 w-full bg-gradient-to-t from-black/70 to-transparent p-2">
              <p class="text-white text-[10px] font-bold truncate">${g.Judul}</p>
            </div>
          </div>`;
        });
      } else { html += `<p class="col-span-2 text-center text-xs text-gray-400 py-4">Belum ada foto.</p>`; }
      html += `</div></div>`;
      document.getElementById('dynamic-content').innerHTML = html;
    }

    // --- FITUR LAMA: LAPOR, IURAN, DARURAT ---
    function showLapor() {
      document.getElementById('dynamic-content').innerHTML = `
        <div class="bg-white p-6 rounded-[32px] card-shadow border border-orange-50">
          <h3 class="font-bold text-lg mb-4 text-orange-600">Form Pengaduan</h3>
          <input id="l-nama" placeholder="Nama Anda" class="w-full p-4 mb-3 rounded-2xl bg-slate-50 border-none text-sm">
          <input id="l-hal" placeholder="Hal yang dilaporkan" class="w-full p-4 mb-3 rounded-2xl bg-slate-50 border-none text-sm">
          <textarea id="l-isi" placeholder="Ceritakan detailnya..." class="w-full p-4 mb-4 rounded-2xl bg-slate-50 border-none text-sm" rows="3"></textarea>
          <button onclick="kirimLaporan()" class="w-full bg-orange-500 text-white py-4 rounded-2xl font-bold text-sm shadow-lg shadow-orange-100">Kirim Laporan</button>
        </div>`;
    }
    function kirimLaporan() {
       const o = {nama:document.getElementById('l-nama').value, judul:document.getElementById('l-hal').value, isi:document.getElementById('l-isi').value};
       if(!o.nama || !o.isi) return alert("Lengkapi data!");
       google.script.run.withSuccessHandler(r=>{alert(r);loadSection('home');}).submitPengaduan(o);
    }
    
    function showIuran() {
      document.getElementById('dynamic-content').innerHTML = `
        <div class="bg-white p-6 rounded-[32px] card-shadow border border-indigo-50">
          <h3 class="font-bold text-lg mb-4 text-indigo-700">Cek Iuran</h3>
          <div class="flex gap-2 mb-4">
             <input id="search-iuran" placeholder="Nama..." class="flex-1 p-4 rounded-2xl bg-slate-50 border-none text-sm">
             <button onclick="cekIuran()" class="bg-indigo-600 text-white px-5 rounded-2xl font-bold"><i class="fa fa-search"></i></button>
          </div>
          <div id="res-iuran" class="space-y-2"></div>
        </div>`;
    }
    function cekIuran(){
       const n = document.getElementById('search-iuran').value;
       const div = document.getElementById('res-iuran');
       div.innerHTML = '<p class="text-center text-xs text-gray-400">Mencari...</p>';
       google.script.run.withSuccessHandler(d => {
         if(!d.length) { div.innerHTML = '<p class="text-center text-red-500 text-xs">Tidak ditemukan.</p>'; return; }
         let h = '';
         d.forEach(x => {
            h += `<div class="p-3 rounded-2xl border ${x.Status==='Lunas'?'border-green-100 bg-green-50':'border-red-100 bg-red-50'} flex justify-between items-center">
              <div><p class="text-[10px] font-bold text-gray-400 uppercase">${x.Bulan}</p><p class="font-bold text-sm text-gray-800">Rp${Number(x.Jumlah).toLocaleString()}</p></div>
              <span class="text-[9px] font-bold px-3 py-1 rounded-full ${x.Status==='Lunas'?'bg-green-600 text-white':'bg-red-600 text-white'}">${x.Status}</span>
            </div>`;
         });
         div.innerHTML = h;
       }).cekIuranWarga(n);
    }

    function showEmergency() {
      let h = `<h3 class="font-bold text-red-600 mb-4 px-2 italic">Telepon Penting</h3>`;
      if(masterData.darurat) masterData.darurat.forEach(d => {
         h += `<a href="tel:${d.Nomor}" class="flex items-center justify-between bg-white p-4 rounded-[24px] mb-3 card-shadow border-l-4 border-red-500"><span class="font-bold text-gray-700 text-sm">${d.Nama}</span><div class="bg-red-100 text-red-600 p-2 rounded-full"><i class="fa fa-phone-alt"></i></div></a>`;
      });
      document.getElementById('dynamic-content').innerHTML = h;
    }

    // --- PENCARIAN & ADMIN ---
    function searchProduct(v) {
       if(!masterData.produk) return;
       const lst = document.getElementById('product-list');
       if(!lst) return;
       const f = masterData.produk.filter(p=>p['Nama Barang'].toLowerCase().includes(v.toLowerCase()));
       let h = '';
       if(f.length) f.forEach(p => {
         h += `<div class="bg-white rounded-[24px] overflow-hidden card-shadow border border-white flex flex-col">
           <div class="h-32 bg-gray-100 w-full overflow-hidden"><img src="${p.GambarURL || 'https://via.placeholder.com/300'}" class="w-full h-full object-cover"></div>
           <div class="p-3 flex flex-col flex-grow"><p class="text-[8px] font-bold text-blue-500 uppercase">${p.Kategori}</p><h4 class="text-sm font-bold text-gray-800 truncate mb-1">${p['Nama Barang']}</h4>
           <div class="flex justify-between items-center mt-auto"><span class="text-blue-600 font-extrabold text-sm">Rp${Number(p.Harga).toLocaleString()}</span><button onclick="orderWA('${p.WhatsApp}', '${p['Nama Barang']}')" class="bg-blue-600 text-white w-8 h-8 rounded-full flex items-center justify-center shadow-md"><i class="fa fa-plus text-xs"></i></button></div></div></div>`;
       }); else h = '<p class="col-span-2 text-center text-xs text-gray-400 py-4">Tidak ditemukan.</p>';
       lst.innerHTML = h;
    }
    
    function orderWA(n,i) { window.open(`https://wa.me/${n.toString().replace(/[^0-9]/g,'').replace(/^0/,'62')}?text=Halo, pesan ${i}`, '_blank'); }

    function showAdminLogin(){
       const p = prompt("Password Admin:");
       if(p) google.script.run.withSuccessHandler(v=>{if(v) renderAdmin(); else alert("Salah!");}).checkAdminLogin(p);
    }
    
    function renderAdmin(){
      const txt = (masterData.pengumuman && masterData.pengumuman.length) ? masterData.pengumuman[0].Isi : '';
      document.getElementById('dynamic-content').innerHTML = `
        <div class="bg-slate-900 text-white p-6 rounded-[32px]">
          <h2 class="font-bold mb-4">Panel Admin</h2>
          <label class="text-[10px] text-gray-400 uppercase font-bold">Pengumuman</label>
          <textarea id="adm-info" class="w-full p-3 rounded-xl bg-slate-800 text-sm mb-2" rows="2">${txt}</textarea>
          <button onclick="saveInfo()" class="w-full bg-blue-600 py-3 rounded-xl text-xs font-bold mb-6">Simpan</button>
          
          <label class="text-[10px] text-gray-400 uppercase font-bold">Tambah Produk</label>
          <input id="p-nm" placeholder="Nama" class="w-full p-3 rounded-xl bg-slate-800 text-sm mb-2">
          <input id="p-hg" placeholder="Harga" type="number" class="w-full p-3 rounded-xl bg-slate-800 text-sm mb-2">
          <input id="p-tk" placeholder="Toko" class="w-full p-3 rounded-xl bg-slate-800 text-sm mb-2">
          <input id="p-wa" placeholder="WA" class="w-full p-3 rounded-xl bg-slate-800 text-sm mb-2">
          <input id="p-img" placeholder="URL Foto" class="w-full p-3 rounded-xl bg-slate-800 text-sm mb-2">
          <button onclick="saveProd()" class="w-full bg-green-600 py-3 rounded-xl text-xs font-bold">Terbitkan</button>
        </div>`;
    }
    function saveInfo(){google.script.run.withSuccessHandler(r=>{alert(r);location.reload()}).updateAnnouncement(document.getElementById('adm-info').value);}
    function saveProd(){
       const o = {nama:document.getElementById('p-nm').value, harga:document.getElementById('p-hg').value, toko:document.getElementById('p-tk').value, wa:document.getElementById('p-wa').value, gambar:document.getElementById('p-img').value, kategori:'Umum'};
       if(!o.nama) return alert("Isi nama produk!");
       google.script.run.withSuccessHandler(r=>{alert(r);location.reload()}).addProductFromAdmin(o);
    }
  </script>
</body>
</html>
